CREATE DATABASE livraria;

CREATE TABLE Cliente (
    CPF       CHAR(11)      NOT NULL,
    nome      VARCHAR(30)   NOT NULL,
    endere√ßo  VARCHAR(100)  NOT NULL,
    telefone  NUMERIC       NOT NULL,
    e-mail    VARCHAR(30)   NOT NULL,
    CONSTRAINT pk_cli PRIMARY KEY (CPF),
    CONSTRAINT uk_cpf UNIQUE (CPF)
);

CREATE TABLE Pedido (
    num_ped     INT   NOT NULL
    cliente     CHAR(11)
    
    ###############################
    
    ID_Func     SERIAL,
    NomeFunc    VARCHAR(50)  NOT NULL,
    Endereco    VARCHAR(80)  NOT NULL,
    DataNasc    DATE          NOT NULL,
    Sexo        CHAR(1)       NOT NULL,
    Salario     DECIMAL(8,2)   NOT NULL,
    ID_Superv   INTEGER         NULL,
    ID_Depto    INTEGER     NOT NULL,
    CONSTRAINT pk_func PRIMARY KEY (ID_Func),
    CONSTRAINT ck_sexo CHECK (Sexo='M' or Sexo='F')
);

CREATE TABLE Projeto (
    ID_Proj       SERIAL,
    NomeProj      VARCHAR(30)  NOT NULL,
    Localizacao   VARCHAR(30)      NULL,
    ID_Depto      INTEGER    NOT NULL,
    CONSTRAINT pk_proj PRIMARY KEY (ID_Proj),
    CONSTRAINT fk_proj_depto FOREIGN KEY (ID_Depto)
       REFERENCES Departamento (ID_Depto),
    CONSTRAINT uk_nomeProj UNIQUE (NomeProj)
);

CREATE TABLE Dependente (
    ID_Dep       SERIAL,
    ID_Func      INTEGER     NOT NULL,
    NomeDep      VARCHAR(50)  NOT NULL,
    DataNasc     DATE          NOT NULL,
    Sexo         CHAR(1)       NOT NULL,
    Parentesco   CHAR(15)          NULL,
    CONSTRAINT pk_depend PRIMARY KEY (ID_Dep),
    CONSTRAINT fk_dep_func FOREIGN KEY (ID_Func)
       REFERENCES Funcionario (ID_Func)
       ON DELETE CASCADE,
    CONSTRAINT ck_sexo_dep CHECK (Sexo='M' or Sexo='F')
);

CREATE TABLE Trabalha (
    ID_Func    SERIAL,
    ID_Proj    INTEGER     NOT NULL,
    NumHoras   DECIMAL(6,1)       NULL,
    CONSTRAINT pk_trab PRIMARY KEY (ID_Func,ID_Proj),
    CONSTRAINT fk_trab_func FOREIGN KEY (ID_Func)
       REFERENCES Funcionario (ID_Func)
       ON DELETE CASCADE,
    CONSTRAINT fk_trab_proj FOREIGN KEY (ID_Proj)
       REFERENCES Projeto (ID_Proj)
       ON DELETE CASCADE
);
